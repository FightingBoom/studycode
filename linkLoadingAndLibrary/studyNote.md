# 第1部分 简介

## 第1章 温故而知新

### 1.1 从 Hello World 说起

从 Hello World 思考一些问题：

  ? 程序为什么要被编译器编译了之后才可以运行？

  ? 编译器在把C语言程序转换成可以执行的机器码的过程中做了什么，怎么做的？

  ? 最后编译出来的可执行文件里面是什么？除了机器码还有什么？它们怎么存放的，怎么组织的？

  ? #include <stdio.h>是什么意思？把stdio.h包含进来意味着什么？C语言库又是什么？它怎么实现的？

  ? 不同的编译器（Microsoft VC、GCC）和不同的硬件平台（x86、SPARC、MIPS、ARM），以及不同的操作系统（Windows、Linux、UNIX、Solaris），最终编译出来的结果一样吗？为什么？

  ? Hello World程序是怎么运行起来的？操作系统是怎么装载它的？它从哪儿开始执行，到哪儿结束？main函数之前发生了什么？main函数结束以后又发生了什么？

  ? 如果没有操作系统，Hello World可以运行吗？如果要在一台没有操作系统的机器上运行Hello World需要什么？应该怎么实现？

  ? printf是怎么实现的？它为什么可以有不定数量的参数？为什么它能够在终端上输出字符串？

  ? Hello World程序在运行时，它在内存中是什么样子的？



### 1.2 万变不离其宗

最为关键的三个部件：中央处理器 CPU 、内存和 I/O 控制芯片；



北桥（Northbridge，PCI Bridge）

南桥（Southbridge）



多核处理器（Multi-core Processor）

> “多处理器应用最多的场合也是这些商用的服务器和需要处理大量计算的环境。而在个人电脑中，使用多处理器则是比较奢侈的行为，毕竟多处理器的成本是很高的。于是处理器的厂商开始考虑将多个处理器“合并在一起打包出售”，这些“被打包”的处理器之间共享比较昂贵的缓存部件，只保留多个核心，并且以一个处理器的外包装进行出售，售价比单核心的处理器只贵了一点，这就是多核处理器（Multi-core Processor）的基本想法。”
>
> 摘录来自
> 程序员的自我修养：链接、装载与库
> 俞甲子 石凡 潘爱民
> 此材料可能受版权保护。



[Free Lunch is Over（免费午餐已经结束了）](http://www.gotw.ca/publications/concurrency-ddj.htm)



### 1.3 站得高，望得远

“Any problem in computer science can be solved by another layer of indirection.”

“计算机科学领域的任何问题都可以通过增加一个间接的中间层来解决”



### 1.4 操作系统做什么

操作系统的一个功能是提供抽象的接口，另外一个主要功能是管理硬件资源。

让计算机硬件发挥所有潜能。



#### 1.4.1 不要让 CPU 打盹

分时系统（Time-Sharing System）



多任务（Multi-tasking）系统，操作系统接管了所有的硬件资源，并且本身运行在一个受硬件保护的级别。所有的应用程序都以进程（Process）的方式运行在比操作系统权限更低的级别，每个进程都有自己独立的地址空间，使得进程之间的地址空间相互隔离。CPU由操作系统统一进行分配，每个进程根据进程优先级的高低都有机会得到CPU，但是，如果运行时间超出了一定的时间，操作系统会暂停该进程，将CPU资源分配给其他等待运行的进程。这种CPU的分配方式即所谓的抢占式（Preemptive），操作系统可以强制剥夺CPU资源并且分配给它认为目前最需要的进程。如果操作系统分配给每个进程的时间都很短，即CPU在多个进程间快速地切换，从而造成了很多进程都在同时运行的假象。











